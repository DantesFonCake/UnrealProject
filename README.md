# MyProject

Developed with Unreal Engine 4

## Доки
### Модуль MyProject
Содержит по большому счёту источники к первым версиям проекта. В общем их можно считать depreceated. К ним же относится MapDrawer blueprint.

### Модуль CustomFluidShader
Не проверенная частичная реализация compute shader реализации жидкостной симуляции на основе [этой штуки](/StamFluidforGames.pdf). Не проверенно и не про тестированно, но может показать пример использования.

### Модуль ResourceMapModule
Основная рабочая часть проекта. Содержит всю существующую инфрастуктуру для создания, настройки и реализации взаимодействий между слоями. Содержит последнюю реализацию жидкостной симуляции
Пройдёмся по классам:
- `ResourceMapManager` -
    Содержит все созданные слои и экземпляры проходов процессоров. Содержит геттеры для всех типов слоёв (без проверок на наличие), методы для добавления слоёв, проверки на наличие и т.д.
    - `GetNamed**(FName name)` - получает экземпляр слоя по имени. Кинет исключение если не найдёт предоставленного имени.
    - `Add**(FName name, дополнительные параметры)` - добавляет слой/поле[^1] в мэнеджер. Дополнительные параметры определяются типом слоя/поля[^1](об этом позже)
    - `AddProccesorToProccesPass(ITimedLayersProccesor* proccesor)` - добавляет экземпляр процессора в специальный массив
    - `ProccesPass(float DeltaTime)` - проходит и выполняет все процессоры из ранее упомянутого массива
    - `Clear()` - очищает состояние мэнеджера. Чистит все массивы и сэты.
    - `**Exists(FName name)` - проверяет наличие слоя/поля[^1] в мэнеджере
    - `IsDynamic(FName name)` - проверяет является ли слой динамическим. Для поля[^1] вернёт false
- `ResourceMapRendererISMC` - занимается рендером данных мэнеджера в игровой мир с использованием [ISMC](https://docs.unrealengine.com/4.27/en-US/BlueprintAPI/Components/InstancedStaticMesh/)
  - `AddLayerDrawable(FName name, bool isDrawable, Material material, int NumCustomData)` - добавляет слой для отрисовки. Имя должно соответвовать имени слоя из мэнеджера. isDrawable - начальное состояние отрисовки, material - материал который будет использован в меше, NumCustomData - количество float'ов которые можно как дополнительные данные
  - `SetLayerDrawable(FName name, bool visible)` - устанавливает видимость отрисовымаемого слоя.
  - `AddToPreRenderPass(FName name, IPreRenderLayersProccesor* pass)` - добавляет препроцессор к слою. Отрабатывает перед рендером слоя. Используется для установок дополнительных данных (см [`WaterPreRenderProccesor`](./Source/ResourceMapModule/Public/WaterPreRenderProccesor.h))
  - `UpdateFromManager()` - сообственно рендер. Обновляет данные мешей из менеджера.
  - `Clear()` - очишает все данные и удаляет меши.
- `**Layer, VelocityField` - содержит все требуемые данные для обработки слоёв, открывает доступ к подлежащим массивам

[^1]: Под полем подразумевается VelocityField